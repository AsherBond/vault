---
layout: docs
page_title: Secrets import
description: Secrets import allows you to safely onboard secrets from external sources into Vault KV for management.
---


# Secrets import

<EnterpriseAlert product="vault" />

@include 'alerts/beta.mdx'

Having collections of secrets across various external systems can present several challenges to an organization, such as
increased operational overhead, a greater risk of secrets sprawl, and more. Vault can offer a single source of truth (SSOT)
solution to managing these secrets, providing increased security and reducing that overhead, yet the effort required
to migrate all your secrets from multiple external sources into Vault can be steep. To aid in this onboarding process,
secrets import provides a mechanism to automate it. 

A secret that is imported from an external system is stored in Vault's KVv2 Secrets Engine. The import process is defined 
an import plan, which is an HCL file. Using HCL enables users to declaratively configure which of their secrets will be read
from an external source and where exactly they will be stored in Vault.

There are three main types of HCL blocks used to configure a secrets import plan. They are source blocks, the Vault destination
block, and mapping blocks.

## Vault destinations

Secrets that get imported are stored into a Vault KVv2 Secrets Engine mount. The destination will accept the mount path of
the desired KVv2 mount and optionally a namespace. This specifies the exact location to store the secrets in. A destination
is defined by an HCL block in the format of `destination_vault`.

### HCL syntax

#### Argument reference

The following arguments are supported:

* `name` - (Required) The name of the Vault destination block used to internally reference this destination inside of a mapping.

* `address` - (Optional) The address of the Vault server with the KVv2 Secrets Engine for which the secrets will be imported into.

* `token` - (Optional) A token for authentication to the Vault server located at the specified address.

* `namespace` - (Optional) The name of the Vault namespace containing the specified KVv2 mount.

* `mount` - (Optional) The name of the KVv2 mount in Vault for which the secrets will be imported into.

#### Example

An example `destination_vault` block may look like the following:

```hcl
destination_vault {
  name = "my-dest-1"
  address = "http://127.0.0.1:8200/"
  token = "root"
  namespace = "ns-1"
  mount = "mount-1"
}
```

## Sources

Secrets can be imported from various external systems, called sources. The supported destinations are:
* [GCP Secret Manager](/vault/docs/import/gcpsm)

A source requires the credentials necessary to read the external system's secrets and their values so that it may import
them into Vault. Either credentials to the system can be directly provided, or you can leverage Vault's capabilities to
geneerate a dynamic secret for the importer to use if you have the corresponding secrets engine configured. A source is
defined by an HCL block in the format of `source_<external_system>`. For example, `source_gcp` defines a source block
for GCP Secret Manager.

### HCL syntax

Refer to a [specific source's documentation](#sources) for details on how to define all remaining arguments of a source
block for that external system type.

#### Example

A `source_<external_system>` block may look like the following, using GCP as an example:

```hcl
source_gcp {
  name = "my-gcp-source-1"
  credentials = "@/path/to/service-account-key.json"
}
```

## Mappings

Mappings blocks are what glue together a source block to a destination block. The supported mapping types are:
* [mapping_passthrough](/vault/docs/import/mappings#passthrough)
* [mapping_metadata](/vault/docs/import/mappings#metadata)
* [mapping_regex](/vault/docs/import/mappings#regex)

A mapping is where filtering logic is defined to control which secrets in the external system will be imported and which will
be ignored. The definition of the rule depends on the type of mapping block that is being configured. Mapping blocks are
applied in order of their given priority.

Once a secret being imported matches a single mapping's rule, it cannot match to another mapping again. A mapping is defined
by an HCL block in the format of `mapping_<filter_type>`. For example, `mapping_regex` defines a mapping block to pass
all secrets through whose secret name passes the given regular expression.

### HCL syntax

See the [mapping documentation](/vault/docs/import/mappings) to see more info regarding specific mapping types and
their arguments.

#### Example

A `mapping_<filter_type>` block may look like the following, using regex as an example:

```hcl
mapping_regex {
  name = "my-map-1"
  source = "my-gcp-source-1"
  destination = "my-dest-1"
  priority = 1
  expression = "^database/.*$"
}
```
